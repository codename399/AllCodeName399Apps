import{a as y}from"./chunk-W7GPKKES.js";import{b as G}from"./chunk-MTLU5R6D.js";import"./chunk-JO3BUMT2.js";import{a as R}from"./chunk-RT3T3EPV.js";import{a as le,c as I}from"./chunk-6EOEJYSQ.js";import"./chunk-BYXBJQAS.js";import"./chunk-WCHE2QXK.js";import{a as re,b as ae}from"./chunk-REQF3J2D.js";import{a as q}from"./chunk-OQLYQHRI.js";import"./chunk-RGF7OKZJ.js";import{A as g,Ba as Q,C as x,D as h,E as D,Ea as $,F as T,Fa as L,G as m,Ga as z,H as r,Ha as H,I as t,Ia as J,J as s,Ja as K,Ka as W,La as X,Ma as Y,Na as Z,Oa as ee,P as A,Pa as te,Q as E,Qa as ie,R as p,S as F,T as w,U as N,V as v,W as a,X as C,Xa as ne,Y as b,_ as U,fa as V,lb as oe,m as f,o as S,p as _,qa as P,u as o,w as k,wa as j,xa as d,ya as O,za as B}from"./chunk-GCSD6NER.js";var M=(e=>(e.Take="Take",e.Give="Give",e))(M||{});function se(n,i){if(n&1&&(r(0,"small",11),a(1),t()),n&2){let e=p(2);o(),C(e.getErrorMessage(e.form,"title"))}}function de(n,i){if(n&1&&(r(0,"small",11),a(1),t()),n&2){let e=p(2);o(),C(e.getErrorMessage(e.form,"description"))}}function ce(n,i){if(n&1&&(r(0,"option",17),a(1),t()),n&2){let e=i.$implicit;m("value",e.id),o(),b(" ",e.name," ")}}function pe(n,i){if(n&1&&(r(0,"small",11),a(1),t()),n&2){let e=p(2);o(),C(e.getErrorMessage(e.form,"toUserId"))}}function ue(n,i){if(n&1&&(r(0,"option",17),a(1),t()),n&2){let e=i.$implicit;m("value",e),o(),b(" ",e," ")}}function fe(n,i){if(n&1&&(r(0,"small",11),a(1),t()),n&2){let e=p(2);o(),C(e.getErrorMessage(e.form,"transactionType"))}}function ge(n,i){if(n&1&&(r(0,"small",11),a(1),t()),n&2){let e=p(2);o(),C(e.getErrorMessage(e.form,"amountToSettle"))}}function xe(n,i){if(n&1){let e=A();r(0,"div",3)(1,"div",4)(2,"div",5)(3,"h4",6),a(4),t(),r(5,"form",7),E("ngSubmit",function(){S(e);let c=p();return _(c.onSubmit())}),r(6,"div",8)(7,"label",9),a(8,"Title:"),t(),s(9,"input",10),g(10,se,2,1,"small",11),t(),r(11,"div",8)(12,"label",12),a(13,"Description:"),t(),s(14,"textarea",13),g(15,de,2,1,"small",11),t(),r(16,"div",8)(17,"label",14),a(18,"To User:"),t(),r(19,"select",15)(20,"option",16),a(21,"Choose..."),t(),D(22,ce,2,2,"option",17,h),t(),g(24,pe,2,1,"small",11),t(),r(25,"div",8)(26,"label",18),a(27,"To User:"),t(),r(28,"select",19)(29,"option",16),a(30,"Choose..."),t(),D(31,ue,2,2,"option",17,h),t(),g(33,fe,2,1,"small",11),t(),r(34,"div",8)(35,"label",20),a(36,"Total Amount:"),t(),s(37,"input",21),t(),r(38,"div",8)(39,"mat-form-field",22)(40,"mat-label"),a(41,"Transaction Date:"),t(),s(42,"input",23)(43,"mat-datepicker-toggle",24)(44,"mat-datepicker",null,0),t()(),r(46,"div",8)(47,"label",25),a(48,"Settled Amount:"),t(),s(49,"input",26),t(),r(50,"div",8)(51,"label",27),a(52,"Amount to settle:"),t(),s(53,"input",28),g(54,ge,2,1,"small",11),t(),r(55,"div",8)(56,"label",29),a(57,"Is Settled:"),t(),s(58,"mat-checkbox",30),t(),r(59,"div",8)(60,"mat-form-field",22)(61,"mat-label"),a(62,"Settlement Date:"),t(),s(63,"input",31)(64,"mat-datepicker-toggle",24)(65,"mat-datepicker",null,1),t()(),r(67,"div",8)(68,"mat-form-field",22)(69,"mat-label"),a(70,"Expected Settlement Date:"),t(),s(71,"input",32)(72,"mat-datepicker-toggle",24)(73,"mat-datepicker",null,2),t()(),r(75,"div",33)(76,"button",34),a(77),t(),r(78,"button",35),E("click",function(){S(e);let c=p();return _(c.showForm=!1)}),a(79," Back "),t()()()()()()}if(n&2){let e=v(45),u=v(66),c=v(74),l=p();o(4),b(" ",l.item?"Update":"Add"," "),o(),m("formGroup",l.form),o(5),x(l.isInvalid(l.form,"title")?10:-1),o(5),x(l.isInvalid(l.form,"description")?15:-1),o(7),T(l.users),o(2),x(l.isInvalid(l.form,"toUserId")?24:-1),o(4),m("disabled",l.item==null),o(3),T(l.transactionTypes),o(2),x(l.isInvalid(l.form,"transactionType")?33:-1),o(9),m("matDatepicker",e),o(),m("for",e),o(11),x(l.isInvalid(l.form,"amountToSettle")?54:-1),o(9),m("matDatepicker",u),o(),m("for",u),o(7),m("matDatepicker",c),o(),m("for",c),o(5),b(" ",l.item?"Update":"Add"," ")}}function Ce(n,i){n&1&&s(0,"app-grid")}var me=class n{#i=f(K);#n=f(P);#o=f(q);#e=f(le);#r=f(R);#t=f(G);form;users=[];transactionTypes=Object.keys(M);get amountToSettle(){return this.form.get("amountToSettle")}gridComponent;get getErrorMessage(){return ae}get isInvalid(){return re}get item(){return this.#e.item}get showForm(){return this.#e.showForm}set item(i){this.#e.item=i}set showForm(i){this.#e.showForm=i}get settledAmount(){return this.form.get("settledAmount")}get totalAmount(){return this.form.get("totalAmount")}get settlementDate(){return this.form.get("settlementDate")}constructor(){this.#e.service=y,this.#e.pagedResponse=this.#n.snapshot.data.pagedResponse,this.#e.displayedColumns=["select","Title","From User Name","To User Name","Description","Transaction Type","Total Amount","Settled Amount","Is Settled","Settlement Date","Expected Settlement Date"],this.form=this.#i.group({title:["",[d.required]],fromUserId:[this.#t.userId,[d.required]],toUserId:["",[d.required]],description:["",[d.required]],transactionType:["Take",[d.required]],totalAmount:[{value:0,disabled:this.item!=null},[d.required]],transactionDate:[new Date,[d.required]],amountToSettle:[0,[d.required]],settledAmount:[{value:null,disabled:!0},[d.required]],isSettled:[{value:!1,disabled:!0},[d.required]],settlementDate:[{value:null,disabled:!0}],expectedSettlementDate:[null]}),this.amountToSettle.valueChanges.subscribe(i=>{i=Number(i),i&&i>0&&(this.settledAmount.setValue((this.item?.settledAmount??0)+i),(this.settledAmount.value??0)>=(this.totalAmount.value??0)?this.settlementDate.setValue(new Date):this.settlementDate.reset())}),V(()=>{this.showForm&&this.form.patchValue(this.item??{})})}ngOnInit(){this.getAllDebtManagerUsers()}onSubmit(){let i=this.form.getRawValue();this.form.valid?this.item?(i.id=this.item.id,this.item=i,this.#e.update()):(this.item=i,this.#e.add()):this.#o.error("Invalid form.")}getAllDebtManagerUsers(){this.#r.getByProject("Debt Manager").subscribe(i=>{i.length&&(this.users=i.filter(e=>e.id!=this.#t.userId))})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=k({type:n,selectors:[["app-debt-manager"]],viewQuery:function(e,u){if(e&1&&F(I,5),e&2){let c;w(c=N())&&(u.gridComponent=c.first)}},features:[U([y])],decls:2,vars:1,consts:[["transactionDatePicker",""],["settlementDatePicker",""],["expectedSettlementDatePicker",""],[1,"container","vh-100","d-flex","justify-content-center","align-items-center"],[1,"card","shadow",2,"width","100%","max-width","400px"],[1,"card-body"],[1,"card-title","text-center","mb-4"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","title",1,"form-label"],["id","title","formControlName","title",1,"form-control"],[1,"text-danger"],["for","description",1,"form-label"],["id","description","formControlName","description",1,"form-control"],["for","toUserId",1,"form-label"],["id","toUserId","formControlName","toUserId",1,"form-select"],["value",""],[3,"value"],["for","transactionType",1,"form-label"],["id","transactionType","formControlName","transactionType",1,"form-select",3,"disabled"],["for","totalAmount",1,"form-label"],["id","totalAmount","formControlName","totalAmount",1,"form-control"],["appearance","fill",1,"datepicker"],["matInput","","formControlName","transactionDate",3,"matDatepicker"],["matSuffix","",3,"for"],["for","settledAmount",1,"form-label"],["id","settledAmount","formControlName","settledAmount",1,"form-control"],["for","amountToSettle",1,"form-label"],["id","amountToSettle","formControlName","amountToSettle",1,"form-control"],["for","isSettled",1,"form-label"],["id","isSettled","color","primary","formControlName","isSettled",1,"form-control"],["matInput","","formControlName","settlementDate",3,"matDatepicker"],["matInput","","formControlName","expectedSettlementDate",3,"matDatepicker"],[1,"d-flex","justify-content-between"],["type","submit",1,"btn","btn-primary"],[1,"btn",3,"click"]],template:function(e,u){e&1&&g(0,xe,80,15,"div",3)(1,Ce,1,0,"app-grid"),e&2&&x(u.showForm?0:1)},dependencies:[oe,Q,H,J,j,z,O,B,$,L,ne,Z,X,Y,W,ee,te,ie,I],encapsulation:2})};export{me as DebtManagerComponent};
